<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise chain</title>
</head>
<body>
    <script>
        function fetchUser() {
            console.log("Bước 1. Gọi fetchUser()");
            return new Promise((resolve) => {
                setTimeout(() => {
                    const user = { id: 1, name: "Alice" };
                    console.log("✅ User fetched:", user.name);
                    resolve(user);
                }, 500);
            });
        }

        function fetchPosts(userId) {
            console.log("Bước 2. Gọi fetchPosts(" + userId + ")");
            return new Promise((resolve) => {
                setTimeout(() => {
                    const posts = [
                        { id: 101, title: "Post A" },
                        { id: 102, title: "Post B" }
                    ];
                    console.log("Posts fetched for user:", userId);
                    resolve(posts);
                }, 500);
            });
        }

        function displayPosts(posts) {
            console.log("Bước 3. Hiển thị tiêu đề bài viết:");
            return new Promise((resolve) => {
                setTimeout(() => {
                    posts.forEach((p) => console.log("Post " + p.id + ": " + p.title));
                    resolve("Tất cả bài viết đã hiển thị");
                }, 300);
            });
        }

        fetchUser()
        .then((user) => fetchPosts(user.id))
        .then((posts) => displayPosts(posts))
        .then((msg) => console.log(msg))
        .catch((err) => console.error("❌ Lỗi:", err));
    </script>
</body>
</html>